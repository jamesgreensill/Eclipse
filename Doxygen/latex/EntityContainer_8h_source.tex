\hypertarget{EntityContainer_8h_source}{}\doxysection{Entity\+Container.\+h}
\label{EntityContainer_8h_source}\index{EclipseEngine/include/EntityContainer.h@{EclipseEngine/include/EntityContainer.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#include <typeindex>}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{keyword}{template} <\textcolor{keyword}{class} TBaseClass>}
\DoxyCodeLine{7 \textcolor{keyword}{struct }\mbox{\hyperlink{structEntityContainer}{EntityContainer}}}
\DoxyCodeLine{8 \{}
\DoxyCodeLine{9     std::unordered\_map<std::type\_index, TBaseClass*> m\_Components\{\};}
\DoxyCodeLine{10     std::function<void(TBaseClass*)> m\_CreationCallback = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{11     std::function<void(TBaseClass*)> m\_DeletionCallback = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{12 }
\DoxyCodeLine{18     \mbox{\hyperlink{structEntityContainer_a2224a60c117c0b184ddda421eb20ecda}{EntityContainer}}(std::function<\textcolor{keywordtype}{void}(TBaseClass*)> creationCallback, std::function<\textcolor{keywordtype}{void}(TBaseClass*)> deletionCallback) :}
\DoxyCodeLine{19         m\_CreationCallback(std::move(creationCallback)), m\_DeletionCallback(std::move(deletionCallback)) \{\}}
\DoxyCodeLine{25     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{26     T* \mbox{\hyperlink{structEntityContainer_ae334377f9e268ae077aae3002c4347af}{AddComponent}}()}
\DoxyCodeLine{27     \{}
\DoxyCodeLine{28         \textcolor{comment}{/*}}
\DoxyCodeLine{29 \textcolor{comment}{         *}}
\DoxyCodeLine{30 \textcolor{comment}{         *  TODO: Assert type is of component.}}
\DoxyCodeLine{31 \textcolor{comment}{         *}}
\DoxyCodeLine{32 \textcolor{comment}{         */}}
\DoxyCodeLine{33         std::type\_index type = \textcolor{keyword}{typeid}(T);}
\DoxyCodeLine{34         TBaseClass* instance = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36         \textcolor{keywordflow}{if} ((instance = GetComponent<T>()))}
\DoxyCodeLine{37             \textcolor{keywordflow}{return} (T*)instance;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39         instance = \textcolor{keyword}{new} T();}
\DoxyCodeLine{40         m\_CreationCallback((TBaseClass*)instance);}
\DoxyCodeLine{41 }
\DoxyCodeLine{42         m\_Components.emplace(type, instance);}
\DoxyCodeLine{43         \textcolor{keywordflow}{return} (T*)instance;}
\DoxyCodeLine{44     \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{50     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{51     \textcolor{keywordtype}{void} \mbox{\hyperlink{structEntityContainer_abadd6ed2dfc752f765e0de09e77d19ae}{RemoveComponent}}()}
\DoxyCodeLine{52     \{}
\DoxyCodeLine{53         \textcolor{comment}{/*}}
\DoxyCodeLine{54 \textcolor{comment}{         *}}
\DoxyCodeLine{55 \textcolor{comment}{         *  TODO: Assert type is of component.}}
\DoxyCodeLine{56 \textcolor{comment}{         *}}
\DoxyCodeLine{57 \textcolor{comment}{         */}}
\DoxyCodeLine{58         std::type\_index type = \textcolor{keyword}{typeid}(T);}
\DoxyCodeLine{59         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& it = m\_Components.find(type);}
\DoxyCodeLine{60 }
\DoxyCodeLine{61         \textcolor{keywordflow}{if} (it == m\_Components.end())}
\DoxyCodeLine{62             \textcolor{keywordflow}{return};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64         m\_DeletionCallback(it-\/>second);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         \textcolor{keyword}{delete} it-\/>second;}
\DoxyCodeLine{67         m\_Components.erase(it);}
\DoxyCodeLine{68     \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{76     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{77     T* \mbox{\hyperlink{structEntityContainer_aa520bd8fba10a6ffa34459129a6946f6}{GetComponent}}()}
\DoxyCodeLine{78     \{}
\DoxyCodeLine{79         \textcolor{comment}{/*}}
\DoxyCodeLine{80 \textcolor{comment}{        *}}
\DoxyCodeLine{81 \textcolor{comment}{        *   TODO: Assert type is of component.}}
\DoxyCodeLine{82 \textcolor{comment}{        *}}
\DoxyCodeLine{83 \textcolor{comment}{        */}}
\DoxyCodeLine{84         std::type\_index type = \textcolor{keyword}{typeid}(T);}
\DoxyCodeLine{85 }
\DoxyCodeLine{86         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& it = m\_Components.find(type);}
\DoxyCodeLine{87         \textcolor{keywordflow}{if} (it != m\_Components.end())}
\DoxyCodeLine{88             \textcolor{keywordflow}{return} (T*)it-\/>second;}
\DoxyCodeLine{89         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : m\_Components)}
\DoxyCodeLine{90         \{}
\DoxyCodeLine{91             T* instance = \textcolor{keyword}{dynamic\_cast<}T*\textcolor{keyword}{>}(pair.second);}
\DoxyCodeLine{92             \textcolor{keywordflow}{if} (instance)}
\DoxyCodeLine{93                 \textcolor{keywordflow}{return} instance;}
\DoxyCodeLine{94         \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{97     \}}
\DoxyCodeLine{98 }
\DoxyCodeLine{105     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{106     std::vector<T*> \mbox{\hyperlink{structEntityContainer_aa2a2942abf7ca07538fe604d440d9d0d}{GetComponents}}()}
\DoxyCodeLine{107     \{}
\DoxyCodeLine{108         \textcolor{comment}{/*}}
\DoxyCodeLine{109 \textcolor{comment}{        *}}
\DoxyCodeLine{110 \textcolor{comment}{        *   TODO: Assert type is of component.}}
\DoxyCodeLine{111 \textcolor{comment}{        *}}
\DoxyCodeLine{112 \textcolor{comment}{        */}}
\DoxyCodeLine{113         std::vector<T*> components\{\};}
\DoxyCodeLine{114 }
\DoxyCodeLine{115         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : m\_Components)}
\DoxyCodeLine{116         \{}
\DoxyCodeLine{117             T* instance = \textcolor{keyword}{dynamic\_cast<}T*\textcolor{keyword}{>}(pair.second);}
\DoxyCodeLine{118             \textcolor{keywordflow}{if} (instance)}
\DoxyCodeLine{119                 components.emplace\_back(instance);}
\DoxyCodeLine{120         \}}
\DoxyCodeLine{121         \textcolor{keywordflow}{return} components;}
\DoxyCodeLine{122     \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{130     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{131     T* \mbox{\hyperlink{structEntityContainer_a1bebbd2f3101ce948a128e3ee24a84dc}{GetComponentInChildren}}()}
\DoxyCodeLine{132     \{}
\DoxyCodeLine{133         \textcolor{comment}{/*}}
\DoxyCodeLine{134 \textcolor{comment}{        *}}
\DoxyCodeLine{135 \textcolor{comment}{        *   TODO: Assert type is of component.}}
\DoxyCodeLine{136 \textcolor{comment}{        *}}
\DoxyCodeLine{137 \textcolor{comment}{        */}}
\DoxyCodeLine{138         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{139     \}}
\DoxyCodeLine{140 }
\DoxyCodeLine{147     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{148     std::vector<T*> \mbox{\hyperlink{structEntityContainer_a3612462ed3456b4c3175f0534845c928}{GetComponentsInChildren}}()}
\DoxyCodeLine{149     \{}
\DoxyCodeLine{150         \textcolor{comment}{/*}}
\DoxyCodeLine{151 \textcolor{comment}{         *}}
\DoxyCodeLine{152 \textcolor{comment}{         *  TODO: Assert type is of component.}}
\DoxyCodeLine{153 \textcolor{comment}{         *}}
\DoxyCodeLine{154 \textcolor{comment}{         */}}
\DoxyCodeLine{155         std::vector<T*> components\{\};}
\DoxyCodeLine{156         \mbox{\hyperlink{structEntityContainer_a3612462ed3456b4c3175f0534845c928}{GetComponentsInChildren}}(components);}
\DoxyCodeLine{157         \textcolor{keywordflow}{return} components;}
\DoxyCodeLine{158     \}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{161     \textcolor{keywordtype}{void} \mbox{\hyperlink{structEntityContainer_a3612462ed3456b4c3175f0534845c928}{GetComponentsInChildren}}(std::vector<T*>\& output)}
\DoxyCodeLine{162     \{}
\DoxyCodeLine{163         \textcolor{comment}{/*}}
\DoxyCodeLine{164 \textcolor{comment}{        *}}
\DoxyCodeLine{165 \textcolor{comment}{        *   TODO: Assert type is of component.}}
\DoxyCodeLine{166 \textcolor{comment}{        *}}
\DoxyCodeLine{167 \textcolor{comment}{        */}}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169 }
\DoxyCodeLine{176     \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{177     \textcolor{keywordtype}{bool} \mbox{\hyperlink{structEntityContainer_acb078fc35f8b85faa9fba05495a2229c}{HasComponent}}()}
\DoxyCodeLine{178     \{}
\DoxyCodeLine{179         \textcolor{comment}{/*}}
\DoxyCodeLine{180 \textcolor{comment}{        *}}
\DoxyCodeLine{181 \textcolor{comment}{        *   TODO: Assert type is of component.}}
\DoxyCodeLine{182 \textcolor{comment}{        *}}
\DoxyCodeLine{183 \textcolor{comment}{        */}}
\DoxyCodeLine{184         std::type\_index type = \textcolor{keyword}{typeid}(T);}
\DoxyCodeLine{185 }
\DoxyCodeLine{186         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& it = m\_Components.find(type);}
\DoxyCodeLine{187         \textcolor{keywordflow}{if} (it != m\_Components.end())}
\DoxyCodeLine{188             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{189 }
\DoxyCodeLine{190         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : m\_Components)}
\DoxyCodeLine{191         \{}
\DoxyCodeLine{192             T* instance = \textcolor{keyword}{dynamic\_cast<}T*\textcolor{keyword}{>}(pair.second);}
\DoxyCodeLine{193             \textcolor{keywordflow}{if} (instance)}
\DoxyCodeLine{194                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{195         \}}
\DoxyCodeLine{196 }
\DoxyCodeLine{197         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{198     \}}
\DoxyCodeLine{199 }
\DoxyCodeLine{200     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{structEntityContainer_abadd6ed2dfc752f765e0de09e77d19ae}{RemoveComponent}}(std::type\_index type)}
\DoxyCodeLine{201     \{}
\DoxyCodeLine{202         \textcolor{comment}{/*}}
\DoxyCodeLine{203 \textcolor{comment}{             *}}
\DoxyCodeLine{204 \textcolor{comment}{             *  TODO: Assert type is of component.}}
\DoxyCodeLine{205 \textcolor{comment}{             *}}
\DoxyCodeLine{206 \textcolor{comment}{             */}}
\DoxyCodeLine{207         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& it = m\_Components.find(type);}
\DoxyCodeLine{208 }
\DoxyCodeLine{209         \textcolor{keywordflow}{if} (it == m\_Components.end())}
\DoxyCodeLine{210             \textcolor{keywordflow}{return};}
\DoxyCodeLine{211 }
\DoxyCodeLine{212         m\_DeletionCallback(it-\/>second);}
\DoxyCodeLine{213 }
\DoxyCodeLine{214         \textcolor{keyword}{delete} it-\/>second;}
\DoxyCodeLine{215         m\_Components.erase(it);}
\DoxyCodeLine{216     \}}
\DoxyCodeLine{217 \};}

\end{DoxyCode}
