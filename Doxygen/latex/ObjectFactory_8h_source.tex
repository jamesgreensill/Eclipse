\hypertarget{ObjectFactory_8h_source}{}\doxysection{Object\+Factory.\+h}
\label{ObjectFactory_8h_source}\index{EclipseEngine/include/ObjectFactory.h@{EclipseEngine/include/ObjectFactory.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <typeindex>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}Object.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}Scene.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}SceneManager.h"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }Eclipse}
\DoxyCodeLine{11 \{}
\DoxyCodeLine{12     \textcolor{keyword}{class }Object;}
\DoxyCodeLine{13 }
\DoxyCodeLine{14     \textcolor{keyword}{namespace }Engine}
\DoxyCodeLine{15     \{}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#define REGTYPE(\_name) \(\backslash\)}}
\DoxyCodeLine{22 \textcolor{preprocessor}{    \_name *create\_ \#\# \_name() \{ return new \_name; \} \(\backslash\)}}
\DoxyCodeLine{23 \textcolor{preprocessor}{    static bool \_name \#\# \_creator\_registered = \(\backslash\)}}
\DoxyCodeLine{24 \textcolor{preprocessor}{                        Eclipse::Engine::ObjectFactory::RegisterCreator(typeid(\#\# \_name), create\_ \#\# \_name)}}
\DoxyCodeLine{25 }
\DoxyCodeLine{29         \textcolor{keyword}{struct }\mbox{\hyperlink{structEclipse_1_1Engine_1_1CreatorEntry}{CreatorEntry}}}
\DoxyCodeLine{30         \{}
\DoxyCodeLine{31             \mbox{\hyperlink{structEclipse_1_1Engine_1_1CreatorEntry}{CreatorEntry}}* Next;}
\DoxyCodeLine{32             std::type\_index index;}
\DoxyCodeLine{33             \mbox{\hyperlink{classEclipse_1_1Object}{Object}}* (*constructor)();}
\DoxyCodeLine{34         \};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36         \textcolor{keyword}{class }\mbox{\hyperlink{classEclipse_1_1Engine_1_1ObjectFactory}{ObjectFactory}}}
\DoxyCodeLine{37         \{}
\DoxyCodeLine{38         \textcolor{keyword}{public}:}
\DoxyCodeLine{42             \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{classEclipse_1_1Engine_1_1ObjectFactory_a42c450eaacd9eb16c32b39f0cd2922de}{RegisterCreator}}(std::type\_index type, \mbox{\hyperlink{classEclipse_1_1Object}{Object}}* (*constructor)());}
\DoxyCodeLine{43 }
\DoxyCodeLine{44             }
\DoxyCodeLine{48             \textcolor{keyword}{template} <\textcolor{keyword}{typename} TObject>}
\DoxyCodeLine{49             \textcolor{keyword}{static} \textcolor{keyword}{auto} \mbox{\hyperlink{classEclipse_1_1Engine_1_1ObjectFactory_a7048962e840de0a46db96b238460f354}{CreateObject}}(\textcolor{keyword}{const} std::string\& name) -\/> TObject*}
\DoxyCodeLine{50             \{}
\DoxyCodeLine{51                 \mbox{\hyperlink{structEclipse_1_1Engine_1_1CreatorEntry}{CreatorEntry}}* tmp(creatorList);}
\DoxyCodeLine{52                 \textcolor{keyword}{const} std::type\_index index = \textcolor{keyword}{typeid}(TObject);}
\DoxyCodeLine{53                 \textcolor{keywordflow}{while} (tmp)}
\DoxyCodeLine{54                 \{}
\DoxyCodeLine{55                     \textcolor{keywordflow}{if} (index == tmp-\/>index)}
\DoxyCodeLine{56                     \{}
\DoxyCodeLine{57                         \textcolor{keyword}{auto} \textcolor{keywordtype}{object} = tmp-\/>constructor();}
\DoxyCodeLine{58                         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{object})}
\DoxyCodeLine{59                         \{}
\DoxyCodeLine{60                             SceneManagement::SceneManager::Instance-\/>GetActiveScene()-\/>AddObject(\textcolor{keywordtype}{object});}
\DoxyCodeLine{61                             \textcolor{keywordtype}{object}-\/>m\_Name = name;}
\DoxyCodeLine{62                             \textcolor{keywordflow}{return} object;}
\DoxyCodeLine{63                         \}}
\DoxyCodeLine{64                     \}}
\DoxyCodeLine{65                     tmp = tmp-\/>Next;}
\DoxyCodeLine{66                 \}}
\DoxyCodeLine{67                 \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{68             \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70             \textcolor{keyword}{template} <\textcolor{keyword}{typename} TObject>}
\DoxyCodeLine{71             \textcolor{keyword}{static} \textcolor{keyword}{auto} CreateObject() -\/> TObject* \{}
\DoxyCodeLine{72                 \textcolor{keywordflow}{return} CreateObject<TObject>(\textcolor{stringliteral}{"{}GameObject"{}});}
\DoxyCodeLine{73             \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75             \textcolor{keyword}{template}<\textcolor{keyword}{typename}...>}
\DoxyCodeLine{76             \textcolor{keyword}{struct }\mbox{\hyperlink{structEclipse_1_1Engine_1_1ObjectFactory_1_1TypeList}{TypeList}} \{\};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78             \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, \textcolor{keyword}{typename} ... TArgs>}
\DoxyCodeLine{79             \textcolor{keyword}{static} \textcolor{keywordtype}{void} CompositeCall(\mbox{\hyperlink{structEclipse_1_1Engine_1_1ObjectFactory_1_1TypeList}{TypeList<T, TArgs...>}}, \mbox{\hyperlink{classEclipse_1_1Object}{Object}}\& \textcolor{keywordtype}{object})}
\DoxyCodeLine{80             \{}
\DoxyCodeLine{81                 \textcolor{keywordtype}{object}.m\_ComponentContainer.AddComponent<T>();}
\DoxyCodeLine{82                 CompositeCall(\mbox{\hyperlink{structEclipse_1_1Engine_1_1ObjectFactory_1_1TypeList}{TypeList<TArgs...>}}(), \textcolor{keywordtype}{object});}
\DoxyCodeLine{83             \}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85             \textcolor{keyword}{static} \textcolor{keywordtype}{void} CompositeCall(TypeList<>, \mbox{\hyperlink{classEclipse_1_1Object}{Object}}\& \textcolor{keywordtype}{object}) \{ \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{90             \textcolor{keyword}{template}<\textcolor{keyword}{typename}...Args>}
\DoxyCodeLine{91             \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classEclipse_1_1Engine_1_1ObjectFactory_af054c5ae4a97b3439efd27d36b85c19c}{CompositeObject}}(\mbox{\hyperlink{classEclipse_1_1Object}{Object}}\& \textcolor{keywordtype}{object}) \{}
\DoxyCodeLine{92                 CompositeCall(\mbox{\hyperlink{structEclipse_1_1Engine_1_1ObjectFactory_1_1TypeList}{TypeList<Args...>}}(), \textcolor{keywordtype}{object});}
\DoxyCodeLine{93             \}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95         \textcolor{keyword}{private}:}
\DoxyCodeLine{96             \textcolor{keyword}{static} \mbox{\hyperlink{structEclipse_1_1Engine_1_1CreatorEntry}{CreatorEntry}}* creatorList;}
\DoxyCodeLine{97 }
\DoxyCodeLine{98             \textcolor{keyword}{static} \textcolor{keyword}{auto} Delete() -\/> \textcolor{keywordtype}{void}}
\DoxyCodeLine{99             \{}
\DoxyCodeLine{100                 \textcolor{keywordflow}{while} (creatorList)}
\DoxyCodeLine{101                 \{}
\DoxyCodeLine{102                     \textcolor{keyword}{const} \mbox{\hyperlink{structEclipse_1_1Engine_1_1CreatorEntry}{CreatorEntry}}* tmp(creatorList);}
\DoxyCodeLine{103                     creatorList = creatorList-\/>Next;}
\DoxyCodeLine{104                     \textcolor{keyword}{delete} tmp;}
\DoxyCodeLine{105                 \}}
\DoxyCodeLine{106             \}}
\DoxyCodeLine{107         \};}
\DoxyCodeLine{108     \}}
\DoxyCodeLine{109 \}}

\end{DoxyCode}
